# Nix Darwin

this is an amalgamation of
- [alex's nix config](https://github.com/agonzalezro/.config)
- [nix-darwin-kickstarter](https://github.com/ryan4yin/nix-darwin-kickstarter)
- [hugolgst/nix-darwin variables](https://github.com/hugolgst/nix-darwin)

## More References

- [LnL7/nix-darwin](https://github.com/LnL7/nix-darwin)
- [home-manager](https://github.com/nix-community/home-manager)
- [macos-defaults](https://github.com/yannbertrand/macos-defaults)
- [ryan4yin/nix-config/modules/darwin](https://github.com/ryan4yin/nix-config/tree/main/modules/darwin)

## How to Use

1. Install Nix package manager via [DeterminateSystems/nix-installer](https://github.com/DeterminateSystems/nix-installer).
2. Clone to `~/.nix-config`
3. Read all the files in this folder, and understand what they do.
   1. If you have trouble understanding, [ryan4yin/nixos-and-flakes-book](https://github.com/ryan4yin/nixos-and-flakes-book) is a good resource to learn nix and flakes.
4. Install Homebrew, see <https://brew.sh/>
   1. Homebrew is required to install most of the GUI apps, App Store's apps, and some CLI apps that are not available in nix's package repository `nixpkgs`.
5. Search `TODO` in this folder, and complete all the TODOs.
6. Run the following command in the root of your nix configuration to start your nix-darwin journey(please change `hostname` to your hostname):

### to build
```bash
sudo nix run . -- build --flake .#work or .#personal 
```

### to switch
```bash
sudo nix run . -- switch --flake .#work or .#personal 
```

### then later you can do
```bash
home-manager-switch
```

## Configuration Structure

Your current nix-darwin configuration's structure should be as follows:

```bash
> tree -a
.
├── assets
│   └── common
│       ├── .atuin.zsh # integration for atuin
│       └── .iterm2_shell_integration.zsh # integration for iterm2 https://iterm2.com/documentation-shell-integration.html
├── configurations 		# a folder contains all your nix-darwin configuration files
│   ├── modules
│   │   ├── default.nix		# imports all the configs below 
│	│   ├── apps.nix        # contains all your homebrew & nix apps(both GUI & CLI)
│	│   ├── host-users.nix  # defines your hostname & all your system users
│	│   ├── nix-core.nix    # nix's core configuration, you can ignore it for now
│	│   └── system.nix      # defines your macOS's system configuration(like dock, trackpad, keyboard, finder, loginwindow, etc.)
│   ├── common.nix		# common between personal and work
│   ├── personal.nix	# personal specific config
│   └── work.nix 		# work specific config
├── home-manager-configs # a folder contains all your nix-darwin configuration files
│   ├── modules
│   │   ├── default.nix		# imports all the configs below 
│   │   ├── core.nix 		# programs managed by home-mananger + other settings
│   │   ├── git.nix			# git config
│   │   ├── shell.nix 		# shell setup - alisaes, files, etc
│   │   └── starship.nix	# starship config
│   ├── common.nix 		# common between personal and work
│   ├── personal.nix 	# personal specific config
│   └── work.nix 		# work specific config
├── flake.lock  	# a lock file generated by nix, you can ignore it for now
├── flake.nix   	# the entry point of your nix configuration, 
└── variables.nix 	# you need to add your details here as they are used throughout the config
```